{"id":41028,"name":"HealthCheck","debugLoggingExpires":"2020-11-09T20:26:59Z","userId":62973,"accountId":48093,"createdDate":"2020-10-12T16:02:59Z","steps":[{"id":435708,"onSuccess":["logSucess"],"onFailure":["disableElementInstance"],"name":"checkHealth","type":"elementRequest","properties":{"elementInstanceId":"${config.instance}","method":"GET","api":"/${steps.getEndpoint}"}},{"id":443814,"onSuccess":["deactivateFormulaTrue"],"onFailure":["sendEmail"],"name":"deactivateFormulaInstance","type":"filter","properties":{"body":"done(config.deactivateFormulaInstance);"}},{"id":444963,"onSuccess":["sendEmail"],"onFailure":[],"name":"deactivateFormulaTrue","type":"request","properties":{"method":"DELETE","api":"/formulas/${info.formulaId}/instances/${info.formulaInstanceId}/active"}},{"id":442680,"onSuccess":["deactivateFormulaInstance"],"onFailure":[],"name":"disableElementInstance","type":"request","properties":{"method":"DELETE","api":"/instances/${config.instance}/enabled"}},{"id":442683,"onSuccess":["checkHealth"],"onFailure":[],"name":"getEndpoint","type":"script","properties":{"body":"done(config.object || \"ping\");"}},{"id":442681,"onSuccess":[],"onFailure":[],"name":"logSucess","type":"script","properties":{"body":"// This would be what happens when a successful call is made.\ndone({success: true});"}},{"id":435707,"onSuccess":[],"onFailure":[],"name":"sendEmail","type":"script","properties":{"body":"if (steps.deactivateFormulaInstance === false){\n  notify.email(`${config.email}`,\"instance failure\", `An API call to an Element with Element Instance Id ${config.instance} has failed with error: ${JSON.stringify(steps.checkHealth.response.body)} and status code: ${JSON.stringify(steps.checkHealth.response.status)}. This instance has been disabled. You can re-enable this instance via the PUT /instances/{id}/enabled API found in the Platform API docs. The Formula instance has not been deactivated.`);\n} else {\n  notify.email(`${config.email}`,`instance failure`, `An API call to an Element with Element Instance Id ${config.instance} has failed with error: ${JSON.stringify(steps.checkHealth.response.body)} and status code: ${JSON.stringify(steps.checkHealth.response.status)}. This instance has been disabled. The associated Formula instance with instance id ${info.formulaInstanceId} for the Formula ${info.formulaName} has also been deactivated. You can re-enable the Element instance via the PUT /instances/enabled API and reactivate the Formula instance via the PUT /formulas/{id}/instances/{instanceId}/active API, both found in the Platform API docs.`);\n}\n\ndone({success: true});"}}],"triggers":[{"id":37116,"onSuccess":["getEndpoint"],"onFailure":[],"type":"scheduled","async":true,"name":"trigger","properties":{"cron":"0 0/15 * 1/1 * ? *"}}],"engine":"v3","active":true,"singleThreaded":false,"debugLoggingEnabled":true,"configuration":[{"id":82226,"key":"deactivateFormulaInstance","name":"deactivateFormulaInstance","type":"value","description":"Would you also like to disable the Formula Instance in the case of an Element Instance failure? Enter: true or false, default is true","required":true},{"id":81035,"key":"email","name":"email","type":"value","required":true},{"id":81036,"key":"instance","name":"instance","type":"elementInstance","required":true},{"id":82083,"key":"object","name":"object","type":"value","description":"Enter the object you want your HealthCheck to send a request to. Default is the `ping` endpoint.","required":false}]}